var messages = [];
function save(e) {
    
    var a = {};
    (a.message_type = "support"),
    (a.first_name = $("#firstname").val()),
    (a.first_name = $("#firstname").val()),
    (a.last_name = $("#lastname").val()),
    (a.oganization_name =$("#organizationname").val()),
    (a.phone_number =$("#phonenumber").val()),
    (a.email =$("#email").val()),
    (a.message =$("#message").val()),
    $.post('http://127.0.0.1/messages', a, function(response) {
        // Log the response to the console
        console.log("Response: "+response);
    });
}


function load() {
    $("#pagesTable").hide(),
        $("#emptyMessage").hide(),
        $("#loading").show(),
        api.questions
            .get()
            .success(function (e) {
                console.log('p:::::::::::::::::::', e);
                (pages = e),
                    $("#loading").hide(),
                    0 < pages.length
                        ? ($("#pagesTable").show(),
                            (pagesTable = $("#pagesTable").DataTable({
                                destroy: !0,
                                columnDefs: [{ orderable: !1, targets: "no-sort" }],
                            })),
                            pagesTable.clear(),
                            (pageRows = []),
                            $.each(pages, function (e, a) {
                                console.log("qqqqqqqqqqqq",a)
                                pageRows.push([
                                    escapeHtml(a.question),
                                    escapeHtml(a.description),
                                    escapeHtml(a.is_phishing), 
                                    moment(a.created_date).format("MMMM Do YYYY, h:mm:ss a"),
                                    "<div class='pull-right'><span data-toggle='modal' data-backdrop='static' data-target='#modal'><i style='color:rgb(0 101 225);margin-right:10px' onclick='edit(" +
                                    e +
                                    ")' class='fa fa-pencil'></i></span>\t\t   <i style='color:red; margin-right:10px' onclick='deletePage(" +
                                    e +
                                    ")' class='fa fa-trash-o'></i></div>",
                                ]);
                            }),
                            pagesTable.rows.add(pageRows).draw(),
                            $('[data-toggle="tooltip"]').tooltip())
                        : $("#emptyMessage").show();
            })
            .error(function () {
                $("#loading").hide(), errorFlash("Error fetching pages");
            });
}
$(document).ready(function () {
    $(".modal").on("hidden.bs.modal", function (e) {
        $(this).removeClass("fv-modal-stack"),
            $("body").data("fv_open_modals", $("body").data("fv_open_modals") - 1);
    }),
        $(".modal").on("shown.bs.modal", function (e) {
            void 0 === $("body").data("fv_open_modals") &&
                $("body").data("fv_open_modals", 0),
                $(this).hasClass("fv-modal-stack") ||
                ($(this).addClass("fv-modal-stack"),
                    $("body").data(
                        "fv_open_modals",
                        $("body").data("fv_open_modals") + 1
                    ),
                    $(this).css("z-index", 1040 + 10 * $("body").data("fv_open_modals")),
                    $(".modal-backdrop")
                        .not(".fv-modal-stack")
                        .css("z-index", 1039 + 10 * $("body").data("fv_open_modals")),
                    $(".modal-backdrop")
                        .not("fv-modal-stack")
                        .addClass("fv-modal-stack"));
        }),
        ($.fn.modal.Constructor.prototype.enforceFocus = function () {
            $(document)
                .off("focusin.bs.modal")
                .on(
                    "focusin.bs.modal",
                    $.proxy(function (e) {
                        this.$element[0] === e.target ||
                            this.$element.has(e.target).length ||
                            $(e.target).closest(".cke_dialog, .cke").length ||
                            this.$element.trigger("focus");
                    }, this)
                );
        }),
        $(document).on("hidden.bs.modal", ".modal", function () {
            $(".modal:visible").length && $(document.body).addClass("modal-open");
        }),
        $("#modal").on("hidden.bs.modal", function (e) {
            dismiss();
        }),
        $("#capture_credentials_checkbox").change(function () {
            $("#capture_passwords").toggle(), $("#redirect_url").toggle();
        }),
        load();
});
